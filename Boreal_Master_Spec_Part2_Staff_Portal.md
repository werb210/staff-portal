üöÄ Boreal Master Specification (V1) ‚Äî PART 2: STAFF-PORTAL (UI + Frontend Logic + Lender Portal)

Codex-Ready Engineering Specification

This document defines the entire Staff-Portal system, including:
‚Ä¢Staff Portal (internal CRM)
‚Ä¢Lender Portal (restricted role inside same codebase)
‚Ä¢UI layout, routing, components
‚Ä¢Pipeline UI
‚Ä¢Document center
‚Ä¢Banking/OCR tabs
‚Ä¢Credit Summary
‚Ä¢Marketing engine UI
‚Ä¢Settings
‚Ä¢Lender product management
‚Ä¢Authentication & roles
‚Ä¢Full interaction with Staff-Server

This spec MUST be followed exactly.
All code produced must follow the patterns already in the Staff-Portal repository (React, Vite, TypeScript, Zustand/React Query, etc).

‚∏ª

1. Purpose of the Staff-Portal

The Staff-Portal is the operational interface for Boreal Financial.
It must:
1.Display every application in the Sales Pipeline
2.Allow staff to review app data, banking, documents, lenders, credit summary
3.Allow lender users to edit ONLY their own company + products
4.Provide admin & settings tools
5.Provide the marketing engine UI
6.Provide the communication center (SMS, email, call logs)
7.Allow secure authentication for Staff, Admin, Lender, and Referrer (future placeholder)

This is the single UI for all non-client users.

‚∏ª

2. High-Level Architecture

2.1 Tech Stack
‚Ä¢React + TypeScript
‚Ä¢Vite
‚Ä¢React Query (API hooks)
‚Ä¢Zustand (global auth + UI state)
‚Ä¢React Router (role-protected routing)
‚Ä¢Tailwind (consistent styling)
‚Ä¢shadcn components for UI consistency
‚Ä¢JWT-based auth (tokens provided by Staff-Server)
‚Ä¢WebSockets for real-time pipeline updates (future, optional placeholder)

‚∏ª

3. Authentication & Role System

Supported roles:
‚Ä¢Admin
‚Ä¢Staff
‚Ä¢Lender
‚Ä¢Referrer (placeholder only)

Rules:
‚Ä¢Login page is the default route.
‚Ä¢All other pages require valid JWT + role.
‚Ä¢Lender users may only see:
‚Ä¢Dashboard (their stats)
‚Ä¢Edit company info
‚Ä¢Edit products
‚Ä¢Staff/Admin users see everything.

2-Factor Authentication
‚Ä¢Staff + Lender use SMS-based 2FA through Staff-Server.

‚∏ª

4. Global Navigation Structure

For Staff/Admin users:
1.Dashboard
2.Sales Pipeline
3.Applications (search)
4.Marketing
5.Lenders
‚Ä¢Lenders
‚Ä¢Lender Products
6.Settings
7.User Management (Admin only)
8.Referrer Portal Placeholder

For Lender users:
1.Lender Dashboard
2.Edit Company Info
3.Edit Products

‚∏ª

5. Sales Pipeline UI (Critical)

Columns:
‚Ä¢New
‚Ä¢Requires Docs
‚Ä¢In Review
‚Ä¢Lender Review (future optional)
‚Ä¢Approved
‚Ä¢Funded
‚Ä¢Declined

Card movement rules (MUST MATCH STAFF-SERVER):
‚Ä¢All new apps with documents ‚Üí New
‚Ä¢Missing required docs or rejected docs ‚Üí Requires Docs
‚Ä¢All docs accepted AND staff opens card ‚Üí In Review
‚Ä¢Staff manually moves to Approved, Funded, Declined
‚Ä¢Must support drag-and-drop, BUT ALSO automatic transitions

Card UI:

Tabs inside each card:
1.Application Data
2.Banking Analysis
3.Financial Data
4.Documents
5.Notes
6.Credit Summary
7.Lenders

‚∏ª

6. Application Detail Tabs (Full UI Spec)

6.1 Application Data
‚Ä¢Display Step 1‚Äì4 answers from Client App.
‚Ä¢Editable by staff.
‚Ä¢Audit logged.

6.2 Banking Analysis
‚Ä¢Display parsed Flinks data or OCR bank data.
‚Ä¢Display:
‚Ä¢Avg balance
‚Ä¢Monthly deposits
‚Ä¢NSF summary
‚Ä¢Risk flags
‚Ä¢Editable notes.

6.3 Financial Data
‚Ä¢OCR summaries of statements (Balance Sheet, Income Statement, AP, AR, etc)
‚Ä¢MUST match Staff-Server OCR spec.

6.4 Documents Tab

Features:
‚Ä¢Preview (presigned URL)
‚Ä¢Download
‚Ä¢Accept / Reject
‚Ä¢Version history
‚Ä¢Re-upload
‚Ä¢Missing file warnings (from staff-server audits)
‚Ä¢Upload logs
‚Ä¢Staff can upload missing docs

When all required docs accepted ‚Üí Staff-Server auto-enables Lenders tab.

6.5 Notes
‚Ä¢Appears as timeline
‚Ä¢Allows staff to add internal notes
‚Ä¢Logged to CRM timeline

6.6 Credit Summary (Popup Modal)
‚Ä¢Generated by Staff-Server
‚Ä¢Must support auto-regeneration
‚Ä¢Must appear as modal overlay
‚Ä¢Must list:
‚Ä¢Business overview
‚Ä¢Key clients
‚Ä¢Summary of terms
‚Ä¢Ownership structure
‚Ä¢Banking highlights
‚Ä¢Financial highlights
‚Ä¢Risk comments

6.7 Lenders Tab
‚Ä¢Show all eligible lender products
‚Ä¢Show ‚Äúlikelihood of success‚Äù score
‚Ä¢Checkbox per lender
‚Ä¢Multi-select send to lenders
‚Ä¢Staff can override rules
‚Ä¢Staff can attach notes to lender submissions

‚∏ª

7. Lender Portal (Built Into Staff-Portal)

7.1 Lender Dashboard

Show stats:
‚Ä¢Time to offer
‚Ä¢Time to fund
‚Ä¢Closing rate
‚Ä¢Volume over time
‚Ä¢Funnel chart

7.2 Edit Company Info

Editable fields:
‚Ä¢Company name
‚Ä¢Contact name
‚Ä¢Email
‚Ä¢Phone
‚Ä¢Website
‚Ä¢Description
‚Ä¢Submission email
‚Ä¢Submission URL
‚Ä¢API credentials (if applicable)

7.3 Edit Products

Lenders can:
‚Ä¢Add new product
‚Ä¢Edit product
‚Ä¢Make inactive
‚Ä¢Delete product
‚Ä¢Upload application forms
‚Ä¢Define required documents (checkbox list + custom add)
‚Ä¢Add commission percentage

‚∏ª

8. Marketing Module (V1 Required Features)

8.1 Attribution Dashboard
‚Ä¢Cost per lead
‚Ä¢Cost per funded deal
‚Ä¢Channel performance
‚Ä¢Funnel conversions
‚Ä¢Product interest by channel

8.2 A/B Testing Suite
‚Ä¢Upload creative A/B
‚Ä¢Track impressions, CTR, spend
‚Ä¢Auto-rotate

8.3 AI Smart Recommendations

AI suggests:
‚Ä¢Better headlines, text, imagery
‚Ä¢Budget moves
‚Ä¢Audience fixes
‚Ä¢Landing page improvements

8.4 Retargeting Automation

Lists:
‚Ä¢Viewed Step 1
‚Ä¢Started app
‚Ä¢No docs
‚Ä¢Rejected docs
‚Ä¢Declined
‚Ä¢Approved but silent

Push lists to Google Ads, Meta, Twitter, LinkedIn.

8.5 Marketing PDF Generator

Monthly performance summary.

8.6 Brand Asset Library

Storage for:
‚Ä¢Images
‚Ä¢Video ads
‚Ä¢Brand templates

8.7 Marketing To-Do System

Shows:
‚Ä¢Fixing weak ads
‚Ä¢Refresh creatives
‚Ä¢Budget changes
‚Ä¢Audience changes

‚∏ª

9. Settings

Staff/Admin settings:
‚Ä¢System configuration
‚Ä¢Lending rules (BF only)
‚Ä¢Default required docs
‚Ä¢Credit summary template tuning
‚Ä¢Banking/OCR display options
‚Ä¢User permissions
‚Ä¢API keys for ads modules
‚Ä¢Placeholder for Referrer Portal settings

‚∏ª

10. Integration Requirements

Staff-Portal must integrate with Staff-Server for:
‚Ä¢Authentication
‚Ä¢Applications fetch
‚Ä¢Pipeline updates
‚Ä¢Document previews & actions
‚Ä¢Credit summary regeneration
‚Ä¢Lender product CRUD
‚Ä¢Marketing data
‚Ä¢Communication logs
‚Ä¢User management
‚Ä¢Settings persistence

All API calls must use React Query hooks with full typing.

‚∏ª

11. Testing Requirements

Codex must generate:
‚Ä¢Component tests (React Testing Library)
‚Ä¢API hook tests (Mock Service Worker)
‚Ä¢E2E pipeline flow tests (Playwright/Cypress)

Must cover:
‚Ä¢Document accept/reject flow
‚Ä¢Version history
‚Ä¢Credit summary modal
‚Ä¢Lender product editing
‚Ä¢Marketing dashboard rendering

‚∏ª

END OF PART 2 ‚Äî STAFF-PORTAL SPEC

When complete, you will request Part 3: LENDER PORTAL (standalone spec).

‚∏ª
